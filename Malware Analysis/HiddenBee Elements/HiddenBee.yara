rule HiddenBeeElement
{
    meta:
        author = "Vigneswaran"
	creationdate = "26.08.2021"
	description = "Sample rule written for 2018-08-Hidden-Bee-Elements"
	

    strings:

	$a = "ntdll.dll" nocase ascii wide fullword
	$b = "kernel32.dll" nocase ascii wide fullword
	$c = "advapi32.dll" nocase ascii wide fullword
	$d = "cabinet.dll" nocase ascii wide fullword
	$e = "msvcrt.dll" nocase ascii wide fullword
	$f = "ws2_32.dll" nocase ascii wide fullword
	$g = "iphlpapi.dll" nocase ascii wide fullword
    
    condition:
    	
	4 of ($*) // any 4 of the provided strings
	
}

import "pe"

rule AgentTesla
{
    meta:
        Author = "Vigneswaran"
	Date = "31.08.2021"
	Description = "Sample rule written for Agent Tesla Open Directory"
	

    strings:
	
	$IntName1 = "zeal.exe"
	$IntName2 = "edu.exe"
	$IntName3 = "Emeka.exe"
	
	$a = "a4attempt.exe" nocase ascii wide 
	$b = "mscore.dll" nocase ascii wide 
	  
    condition:
    	
	uint16(0) == 0x5A4D
	and pe.imphash() == "f34d5f2d4577ed6d9ceec516c1f5a744"
	and (any of ($IntName*)) and $a and $b
	
}
